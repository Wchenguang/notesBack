计算机组成原理笔记
------

# 第三章 存储系统

## 3.1 存储器的分类

### 存储介质分
* 半导体存储器 
* 磁表面存储器
* 光存储器

### 读写性质分
* 随机读写存储器RAM
	* 静态SRAM，动态DRAM
	* 断电则消失，成为易失存储器
* 只读存储器 ROM
	* 内容断电不消失

### 计算机层次作用分
* 主（内）存储器
* 辅助（外）存储器
* 高速缓冲存储器（Cache）

## 3.2 存储器的层次结构
### 存储器的3个重要指标
* 速度
* 容量
* 每位价格

### 结构 速度快到慢，容量小到大，价格高到低
* 寄存器
* 缓冲
* 主存
* 磁盘
* 光盘
* 磁带

### 存储系统运行遵循的原理
* 程序运行的局部性原理：时间 空间 顺序
* 一致性原则和包含性原则
	* 一致性：同一个信息存在于不同层次，必须保持相同值
	* 包含性：内层信息一定外层存储器信息中的一小部分的副本

## 3.3 RAM

### SRAM
* 依靠双稳态电路内部的交叉反馈机制存储信息
* 特点：速度快，功耗大集成度低
* 静态存储单元保存的信息比较稳定，信息为非破坏性输出
* 结构简单，可靠性高，速度较快
* 占用元件多，功耗大，集成度低

### DRAM
*  依靠电荷的多少表示1，0，需要每隔2ms刷新
* 依靠电容存储电荷的原理存储信息
* 功耗低，集成度较高，速度快
* 刷新详述
	* 刷新方法：各个动态芯片同时刷新，片内按行刷新，刷新一行所用的时间为刷新周期（存取周期），因此刷新一块芯片的刷新周期数由芯片矩阵的行数决定
	* 刷新周期的安排方式
		* 集中式刷新：在2ms内集中刷新所有片：用在实时性要求不高
		* 分散式刷新：各个刷新周期分散安排在存取周期中：用在低速系统中
		* 异步刷新：每隔一段时间刷新一行（固定时间）：用在一般计算机

## 3.4 ROM

1. ROM：以元件的有无判断0，1，不可编程
2. PROM：可编程，只一次，熔丝式
3. EPROM：可编程，紫外线
4. E2PROM：可编程，电擦除
5. Flash Memory：兼具ram，rom，大容量，非易失去性，在线改写，高速读

## 3.5 主存储器的组成与控制
* 控制信号到控制电路
* 控制电路控制各个模块
* M位地址总线-MAR-地址译码器-存储体<->读写电路<->MDR<->N位数据总线
* MAR-存储器地址寄存器
* MDR-存储器数据寄存器

### 存储器的结构以及功能
1. 半导体 的基本组成：地址译码器，存储矩阵，三态双向缓冲器，存储控制逻辑
	* 存储矩阵：许多基本单元链接在一起，每一个基本单元存放一位二进制
		* 子结构：横向，每一行是一个字，每个字是数个基本单元表示该字的每一位
		* 位机构：纵向，每一列是不同字的同一位
	* 地址译码器
			* 功能：		接受系统总线传来的地址信号，产生地址译码信号，选中存储矩阵中的某个或某几个基本存储单元
			* 双译码比单译码需要更少的译码线
	* 存储器控制电路
		* 功能：通过存储器控制信号的引线端接受来自CPU或外部的控制信号	，经过组合变换后	对存储矩阵	，地址译码器，三态双向缓冲門进行控制

## 3.6 主存储器与CPU的链接
* 存储容量 = 存储字数 * 字长
* 存取时间 Ta（存储器从接受到寻找存储单元的地址码开始到读出或存入数据为止所需的时间）
* 存储周期TM（CPU连续两次访问存储器所需要的最短时间间隔）存储周期略大于取指周期

## 3.6

### 3.6.1 主存储器容量的扩展
1. 位扩展
 	* 用多个存储器器件对字长进行扩充
 	* 将多片存储器的地址线，片选端，读写控制端并联，数据端分别引出

2. 字扩展
 	* 多个存储器对字数进行扩展
	* 将各个芯片的地址线，数据线，读写控制并联，由片选信号来区分各个芯片的地址范围

### 3.6.2 存储器芯片与cpu的链接
* 全译码
	* 实际使用的存储空间与cpu可访问的最大存储空间相同
	* 实际使用的存储空间小于cpu可访问的最大空间，但是对访问地址范围有严格的限制

### RAM和ROM都是随机存输入输出（I/O）系统取的方式进行信息访问
### 主存由存储体，译码，控制组成
### 基本操作 读写
### 与CPU链接	译码 片选

## 3.7
* 引入高速缓冲存储器
	* 解决cpu与主存之间的速度差异，提高运算速度
	* cache：由高速SRAM组成
* chche特点
	* 存取速度快，容量小
	* 透明性：存储控制和管理由硬件实现

## 3.7.1 cache的基本工作原理
* 程序访问的局部性原理
	* 程序：由指令和数据组成输入输出（I/O）系统
	* 局部性：在较短时间内，由程序产生的地址往往集中在存储器地址空间的一个很小范围
		* 时间局部性：某个存储单元在很短的时间段内可能被重复 访问
		* 空间局部性：某个存储单元被访问，其临近单元很快可能被访问
* cache的功能
	* 将主存中被频繁访问的活跃程序块和数据块复制到cache中
	* 大多数情况，cache可以直接向cpu提供指令和数据
	* c输入输出（I/O）系统ache存放的主存内容的小部分副本
* cache的组成
	* 主存中的区域称为块，一个块由若干定长度的字组成。
	* chche中存放一个块的区域称为行或槽
	* 每一cache行外加一个标记，指名他是主存哪一块的副本
	* 为了识别一个chche行中的信息是否有效，在标记中加有效位
* cache工作流程
	* 命中与不明中cache，通过主存大地址
	* 如果命中，将主存地址变换成cache小地址，送入cache，cache读出字送到CPU的数据总线DB
	* 如果不明中，主存将读出的字送到DB，同时将该字所在的块复制到cache，如果cache可以装入就写入，否则替换算法

* cache命中率：访问到cache的次数/所有访问次数
	* cache的命中率	与地址映像的方式和cache的容量有关
	* cache的容量大命中率高

* cache 主存系统平均访问时间：htc + (1-htc)tm

## 3.7.2 cache的地址映射方式
### 直接映像
* 将 主存分为与cache等大的不同区，每个区由与cache行数相等的块，块对应唯一行，行对应很多块
* 主存地址格式：所在区+cache内行号+块内地址
* cache地址：cache行号+块内地址
* 实现简单，判断方便。	cache利用率低

### 全相联映像
* 每个主存块可以映像到cache的任意行
* 可从已被沾满的cache替换出任意行
* 主存地址格式：主存块号+块内地址
* cache地址：块号标记+块内地址
* cache标记位数多需要遍历
* 成本高时间多不适合容量大的cache

### 组相联映像
* 两者结合，将cache分组，分成一组直接，每行一组全

## 3.7.4 cache的更新与替换方式
* cache更新：确保cpu写操作，主存与cache内容都更新
	* 写贯穿：同时写入cache和主存
	* 写回法：先写入cache在特定时间将cache写入主存，效率高，一致性差
* cache替换：当位置被占
	* 随机替换算法
	* 先进先出算法
	* 最近最少使用算法（LRU）：cache每一块设置计数器，提高命中率

## 3.9 虚拟存储器
* 虚拟存储系统的特点
	* 允许用户用比主存空间大得多的空间访问主存
	* 每次访存要自动进行虚实地址转换

* 虚拟存储系统
	* 主存空间：取决于系统中实际使用的主存容量
	* 虚存空间：取决于虚地址长度
	* 辅存空间：取决于系统中实际使用的辅存容量




# 第四章 指令系统

## 4.1 指令格式
* 指令：指示计算机执行某项基本操作功能的命令，是计算机运行的最小功能单位
* 指令系统：计算机所支持的所有指令的合集
* 指令系统设计：
	* 完备性：常用指令齐全，编程方便
	* 高效性：程序占内存少，运行速度快
	* 规整性：指令和数据使用规则简单，易学易记
	* 兼容性：低档能在高档运行

### 指令的结构
* 指令字：代表指令的一组二进制代码信息
* 指令字长：指令字中二进制代码的位数
	* 定长指令：便于控制
	* 变长指令：合理利用存储空间
* 典型：操作码OP+地址码A
	* OP：指明操作性质的命令码，提供指令的操作控制信息
	* A：操作数存放的地址，有时是操作数本身(立即数)

### 4.1.2 操作码字段的格式
* 定长操作码
	* 各个指令OP的位置、位数固定相同
	* 可以简化硬件设计
* 变长操作码
	* 指令OP的位置，位数不固定。根据需要变化
	* 可以表示更多指令

### 4.1.3 操作数地址字段的表示与编码
* 不同指令使用不同数目、不同来源去向、不同用法的操作数，要尽量安排在操作数字段
* 指令中提供的地址
	* 寄存器编号
	* 内存储单元地址码
	* I/O端口地址码
* 指令提供地址的方式
	* 显地址：指令中明显指明地址
	* 隐地址：地址隐含约定，不出现在指令中
* 指令地址长度与个数
	* 三地址：15
	* 二地址：14
	* 一地址：31
	* 零地址：16
### 4.1.4 数据在存储器中的存放方式
* 按字节存储
* 边界对齐：便于硬件实现，填充空白
* 小端格式：字节编址的数据存放次序是低地址存放低字节，高地址存放高字节

## 4.2 寻址方式
* 寻址方式是指确定本条指令的数据地址下一条将要执行的指令的地址的方式，分为指令寻址与数据寻址
	* 指令寻址
		* 顺序寻址：可以通过程序计数器pc加1自动形成下一条指令的地址
		* 跳跃寻址：通过转移类指令，通过对PC的运算得到新的下一条指令的地址
	* 数据寻址：寻找操作数地址或操作数的方式，如何对地址字段做出解释找到操作数
		* 形式地址：指令中地址码给出的地址，用A表示
		* 有效地址：形式地址经过某种运算而得到的能直接访问主存中操作数的地址，记为EA，是寻址方式和形式 地址共同决定的

### 4.2.1 常见寻址方式
* 立即寻址：指令直接给出操作数：操作码+立即数
* 直接寻址：指令的操作数地址字段直接给出操作数在存储器中的地址：操作码OP+有效地址A
* 寄存器寻址：操作码+寄存器号R--S = (R)--访问R比M快
* 间接寻址：
	* 存储器间址：指令给出操作数的间接地址OP+A-S=((A))--存储单元号，寄存器号在M中
	* 寄存器间址：操作码+寄存器号----S=((R))----R所占位数少，可提供全字长地址码，修改R比M快，指针不变指针内容变
	* 堆栈寻址：操作码+堆栈指针SP----S=((SP))--- 堆栈向上生成
* 变址、基址及其寻址
	* 变址
		* 指令给出一个寄存器号和一个变址偏移量，寄存器内容与偏移量之和为有效地址----op+R+A----S = ((R)+A)----A为基准量----R为修改量
	* 基址寻址
		* 类似变址 不过寄存器R给出基准量，A给出修改量	
	* 相对寻址
		* op+pc+a----S=((pc)+-a)
		* 取址后PC加一个字长
### 4.3.2 逻辑运算指令
* 设置：或 测试，清除：与， 修改：异或
### 4.3.4 程序控制指令
* 转移指令
	* 无条件转移：操作码+转移地址
	* 条件转移：操作码：转义地址：转移条件
	* 循环：转移条件为循环计数值

* CISC：复杂指令系统计算机
* RISC：精简指令系统计算机
* RISC的优化
	* 优先选取使用频率最高的一些简单指令
	* 指令长度固定
	* 只有存数/取数指令访问内存
	* cpu中寄存器数量很多
	* 大部分指令在一个或小于一个机器周期完成
	* 硬布线控制为主，不用或者少用微码控制
	* 重视编译优化

#第四章--------------------------------------------pdf最后的题目
------

# 5.1 CPU的功能和基本结构

* 主要功能：数据处理，操作控制，时间控制，异常处理
* 基本组成：运算器，控制器，寄存器，时钟电路

## 5.1.1 CPU的功能

* 运算器：实现算数运算与逻辑运算 数据加工
* 控制器：取指令，分析指令，执行指令，控制程序输入以及结果输出，总线管理，处理异常和特殊请求
	* 是指挥与控制整台计算机各个功能部件协同工作，自动执行计算机程序的部件，其作用是控制指令的执行过程
	* 能够正确并且自动连续地执行指令
	* 正确地分步完成每一条指令规定的功能
	* 读取指令-分析指令-执行指令
	* 向计算机各个功能部件提供协调运行每一个步骤的所需要的控制信号
	* 控制器的功能
		* 从程序首地址开始执行第一条指令
		* 分步执行每一条指令，并形成下一条待执行的指令地址
		* 自动连续执行指令

## 5.1.2 CPU的基本结构
* cpu与系统总线
	* 指令控制：PC，IR
	* 操作控制 与 时间控制：CU，时序电路
	* 数据加工：ALU，寄存器
* cpu的寄存器
	* 通用寄存器：提供操作数，保存运算结果，用作指针地址，用作计数器
	* 控制寄存器：程序计数器PC，指令寄存器IR，程序状态寄存器PSW(标志寄存器)----控制CPU操作：PC->MAR->M->MDR->IR----只有PC用户可见
	* 控制寄存器
		* 程序计数器PC：通过PC内容的不断更新，控制机器执行指令序列的进程，保证程序能自动连续执行
		* 指令寄存器IR：用于存放现行指令，当执行一条指令，首先从内存将指令取出到指令寄存器IR，然后送到指令译码器ID，产生各种微操作命令
		* 程序状态字PSW：记录算数和逻辑运算指令建立的各种条码信息，如进位，零，符号，溢出。还可保存中断和程序的工作状态等信息
		* 主存相关寄存器
			* MAR：主存地址寄存器----存放将被访问的存储单元地址
			* MDR：存放将存入主存的数据或最近从主存读出的数据

## 5.1.3 控制单元 CU
* cu产生全部微操作命令序列
* 控制器需要解决的问题
	* 为什么需要控制信号
	* 需要什么控制信号
	* 如何产生控制信号
* 控制器的组成
	* 程序计数器PC
		* 存放指令地址，有增量或接受新值功能
	* 指令寄存器IR
		* 存放指令内容：操作码与操作数
* 指令译码器ID
	* 对指令寄存器中的操作码进行分析解释，产生相应的控制信号
* 指令执行步骤标记路线
	* 指名每条指令的步骤和相对次序关系
* 控制信号产生线路
	* 依据指令操作码，指令的执行步骤和某些条件信号，给出当前执行步骤中计算机各个功能部件需要的控制信号
	* 脉冲源与启停线路
		* 启动停机
* 两种不同类型的控制器
	* 根据指令步骤标记线路和控制信号产生线路不同的组成和不同运行原理
		* 硬连线控制器：采用组合逻辑线路，依据指令及其执行步骤直接产生控制信号
		* 微程序控制器：采用存储电路把控制信号存储器来依据执行步骤读出信号
	
# 5.2 指令的执行步骤与指令周期

## 5.2.1 指令的执行步骤
* 读取指令（IF）-> 指令译码/读寄存器（ID）-> ALU执行运算/计算有效地址（EX）-> 访问内存（M）-> 结果写回寄存器

## 5.2.2 指令周期概述
* 指令周期：CPU取出并执行一条指令所需的全部时间
* 取指周期（取指、分析）-> 执行周期（执行）
* cpu工作周期的标志
	* 取指令：取指周期
	* 取地址：间址周期
	* 取操作数：执行周期
	* 存程序断点：中断周期

## 5.2.3  指令周期的数据流
* 取址周期数据流：PC-MAR-AB -M（主存）-DB-MDR-IR        PC+1
* 间址周期数据流：Ad(MDR)-MAR-AB-M-DB-MDR
* 执行周期数据流：不同指令不同
* 中断周期数据流：SP-MAR-AB-M    PC-MDR-M     中断周期入口PC

## 5.2.4 指令执行过程

# 5.3 微程序控制器原理

## 5.3.1 微程序控制的基本思想
* 概念
	* 微操作
		* 不能分解的操作
	* 微指令
		* 指分为多条微小指令
	* 机器指令-微程序-微指令-微命令-微操作
* 微程序控制的基本思想
	* 若干微命令编制成一条微指令，控制实现一步操作
	* 若干微指令组成微程序，解释执行一条机器指令
	* 微程序事先存储在控制存储器中，执行机器指令时取出，执行一条机器指令就是执行一段存放在控制存储器中的微程序
	* cpu的构成-引入了程序技术，使设计规整-引入了存储逻辑，使功能易于扩展

## 5.3.2 微程序控制器组成原理
* 主要部件
	* 控制存储器CM
		* 功能：存放微程序
		* CM属于CPU，不属于主存储器
	* 微指令寄存器	 miuIR
		* 功能：存放现行微指令
		* 组成：微命令字段（提供一步操作所需的微命令）微地址字段（知名后续微地址的形成方式）
	* 微地址形成电路：提供两类地址
		* 微程序入口地址：由机器指令操作码形成
		* 后续微地址：微地址字段，现行微地址，运行状态
* 工作过程
	* 取机器指令
		* CM 取指微指令-miuIR 微命令字段-译码器 将微命令送到-主存-主存把机器指令送到IR
	* 转微程序入口
		* IR 将操作码送到 -微地址形成电路-入口是 miuAR-CM 将首条微指令送到miuIR
	* 执行首条微指令
		* miuIR 将微命令字段送到 -译码器- 将微命令送到-操作部件

# 待完成

# 第六章 总线

## 6.1 总线概述

### 6.1.1总线的基本概念
* 总线是信息传输的多个部件所互连的一组公共信号通路和计算机系统的互连机构
* 作用：多个部件之间公用的传送信息的一组连线，作用是在争用总线的基础上，按照系统约定分时为计算机各部件进行数据，地址和控制信号的发送和接收等服务
	* 某一时刻，只允许一个部件向总线发送消息而多个部件可以同时从总线接受消息
	* 计算机与总线相连的输出部件均为三态缓冲器
* 总线具有机械，功能，电气，时间特性（cpu发出为输出，发向cpu为输入）
* 总线的分类
	* 并行总线：多条线同时传递所有的二进制位数，速度快结构复杂，大量采用
	* 串行总线：多位二进制信息共用一位信号线传递速度慢，但是结构简单，部件之间距离较远时，用串行总线可以降低成本，提高可靠性
* 总线位置：单处理机系
	* 内部总线：CPU内部连接各寄存器及运算部件之间的总线
	* 系统总线：计算机各高速部件之间的信息传输线
		* 数据总线：双向，与机器字长，存储字长有关
		* 地址总线：单向，与存储地址，I/O地址有关
		* 控制总线：部分出，部分入，控制器控制所有部件
	* I/O总线：用于CPU与中低速的外部设备、计算机系统之间或计算机系统与其他系统之间的通信，也是通信总线或外部总线

### 6.1.2 总线的结构
* 总线组成：信号线，总线控制器，收发电路，转换器
* 系统总线的结构通常分为单总线和多总线
	* 单总线：将CPU，主存，I/O设备都挂在一组总线上
	* 多总线结构：将速度较低的I/O设备从单总线上分离出来，形成主总线与I/O设备总线分开的结构

### 6.1.3 总线主要性能指标
* 总线宽度：并行传输数据的位数，即数据总线的根数
* 总线带宽：总线本身所能达到的最高数据传输速率：总线带宽 = 总线宽度 x 总线频率
* 时钟同步/异步：总线上的数据与时钟同步的称为同步总线，不同步的为异步总线
* 总线复用：一条信号线上分时传送两种信号
* 信号线数：地址总线、数据总线、和控制总线三种总线的和
* 总线控制方式：包括突发工作、自动配置、仲裁方式

## 6.2 总线操作和定时
1.  
	* 总线的各设备，按其对总线有无控制功能分为主设备和从设备
	* 主设备对总线有控制权，由它启动总线信息传送
	* 从设备只能响应主设备发来的总线命令对总线没有控制权
	* 多个主设备要同时使用总线时，由总线控制器判优，仲裁
2. 
	* 主要的总线操作
		* 读和写
			* 读：将从设备中的数据读出并经总线传输到主设备
			* 写：主设备到从设备的数据传输过程
		* 块设备
			* 突发传输：一次总线事务中，主设备只需给出一个首地址，从设备就从首地址开始的若干连续单元一个一个地读出或写入多个固定长度的数据 把地址给你你自己搞到手一个地址传输时间加上数据获取时间
------
3. 
	* 定时：指事件出现在总线上的时间关系。总线常用的定时协议有同步定时方式和异步定时方式
		* 同步定时方式：以时钟周期为划分时间段的基准，要求所有的模块由统一的时钟脉冲进行操作的控制
		* 各个模块的所有动作均在时钟周期的开始产生，并且多数动作在一个时钟周期内完成
		* 同步定时的主要特点
			* 同步定时具有较高的传输频率
			* 同步定时适用于总线长度较短，各个功能模块存取时间比较接近的情况
			* 由于同步总线必须按最慢的模块来设计公共时钟，当各个功能模块存取时间相差较大，会使总线的效率降低
		* 异步定时方式：异步定时方式允许各个部件速度不一致，没有统一的时钟周期划分，而采用应答方式与互锁机制实现总线的操作，所需时间视需要而定
		* 对于异步操作，操作的发生由通信双方互相提供联络信号，总线上一个事件的发生取决于前一个事件的发生
		* 优点：总线周期长度可变，不把响应时间强加到功能模块上，因而允许快速和慢速的功能模块连接到同一总线上
		* 缺点：会增加总线的复杂性和成本
* 异步应答关系分为 不互锁，半互锁，全互锁

## 6.3 	总线标准
* 总线标准：系统与各个模块，模块与模块之间的一个互连的标准界面
	* 保证总线性能发挥
	* 标准总线具有物理，电气，功能，时间特性
* 系统总线：ISA，EISA，PCI
* 设备总线：SCSI，RS232，USB
* USB：只能传送单比特数据


# 第七章 输入输出系统

## 7.1 I/O系统基本概念

### 7.1.1 输入输出（I/O）系统
* 需要解决：各种形式的信息进行输入输出的控制
* 外设：输入/输出设备是外部设备，简称外设，计算机与外设之间的信息交换成为输入输出
* 接口：外设与总线之间的中间环节，在完成各个外设和主机之间数据的传输过程中，进行各种协调工作的部件或电路
* 端口：接口中可以被访问的单元，有独立的端口地址，可分为数据端口，状态端口，控制端口

### 7.1.2 发展概况
* 早期：分散连接：CPU和I/O串行方式工作，程序查询方式
* 接口模块和DMA阶段：总线连接，CPU和i/o并行工作：中断方式或DMA
* 具有通道结构
* 具有I/O处理机的阶段

## 7.2 I/O接口
* I/O接口：指主机和外设的交接部分，在主机和外设之间的逻辑部件，也称设备控制器、设备适配器或I/O接口电路
* I/O接口位于系统总线和外设之间，控制并实现主机与外部设备的数据传送
* 接口分类
	* 数据传送格式划分
		* 并行接口
			* 接口与系统总线，接口与外设均按照并行方式传送数据
			* 数据各位同时传送
			* 适用于设备本身并行工作，距离主机较近的场合
		* 串行接口
			* 接口与系统总线并行传送
			* 接口与外设串行传送
			* 数据逐位分时传送
			* 适用于设备本身串行工作，或距离主机较远或减少传送线
	* 按时序控制方式划分
		* 同步接口：接口与系统总线传送由统一时序信号控制
		* 异步接口：接口与系统总线的信息传送采用异步应答方式
	* 按照数据传送控制方式划分
		* 程序控制接口
		* 中断接口
		* 直接存储器存取接口
		* 通道控制

### 7.2.2 I/O接口的主要功能
* 寻址
	* 接受CPU发来的地址码，进行地址译码，选择接口中的不同端口，供CPU访问
* 缓存
	* 对主机与外设交换的数据进行缓冲和锁存，实现主机与外设的匹配速度
* 状态
	* 对外设或接口的 忙 就绪等状态信息实现保存，应变和传送
* 控制
	* 通过指令指定设备或端口的操作
* 中断
	* 需要时候 可以进行中断
* 转换
	* 提供信号格式转换或电平转换

### 7.2.3 I/O接口的基本结构

### 7.2.4 I/O端口与编址方式

* I/O端口
	* 为使CPU能选择设备并进行数据传送，接口中通常都具有多个可由CPU进行读或写的寄存器或电路

* I/O端口的编址
	* I/O端口与存储器统一编址
		* 把一个外设端口看作存储器的一个单元，占用存储器的地址空间，利用对存储器的读写操作完成数据的输入和输出
			* 优点
				* 不需要专门的输入输出指令
				* 可以使用全部对存储器操作的指令
				* 端口数量多
			* 缺点
				* 占用存储器空间
				* 寻址地址线数多，译码电路复杂
		* I/O端口独立编址
			* 计算机单独给外设端口编址，I/O端口具有独立的地址空间
				* 优点
					* 译码电路简单
					* 不占存储
				* 缺点
					* 专门输入输出指令，寻址方式少，不灵活
## 7.3 I/O数据传送控制方式
* 常用的I/O控制方式
	* 程序直接控制方式
	* 程序中断控制方式
	* 直接存储器存取（DMA）方式
	* I/O通道控制方式
	* 外围处理机方式

### 7.3.1 程序直接控制方式
* 基本概念
	* CPU执行一段I/O程序实现与外设之间数据传送
	* 最简单的方法
* 无条件传送：只有在外设总处于准备好状态采用
* 优点
	* 较好协调主机与外设之间的时间差异，所用硬件少
* 缺点
	* 主机与外设只能串行工作，主机一段时间只能与一个外设进行通讯，CPU效率低
* 工作流程
	* CPU执行初始化程序，预设传送参数
	* 从外设接口读取状态
	* CPU 查询状态，知道准备就绪
	* 传送一次数据
	* 修改地址和计数参数
	* 判断结束

### 7.3.2 程序中断方式
* 基本概念
	* 中断：CPU暂时中止当前程序运行，转去处理随机出现的情况或有意安排的任务，在处理结束后能自动回复原程序的执行
	* 中断源：引起中断的事件或中断的来源
	* 实质：程序切换：方法（保存断点，保护现场，恢复现场，返回断点）时间（一条指令结束时切换，保证程序的完整性）
	* 中断分类
		* 硬中断（硬件请求）与软中断（软中断指令）
		* 内中断（主机内部）与外中断（主机外部）
		* 可屏蔽中断与非屏蔽中断
		* 向量中断（硬件提供服务程序地址）非向量中断（软件提供服务程序地址）
	* 中断系统的组成
		* 软件：服务程序，中断向量表
		* 硬件：接口方面（请求，传递，判优逻辑）CPU方面响应逻辑
	* 中断过程
		* 中断请求，中断响应，状态保护，中断屏蔽，中断处理，回复和返回
	* 中断作用和功能
		* CPU与IO并行工作，提高CPU效率
		* 利用中断处理故障，提高机器的可靠性
		* 实现人机联系
		* 实现多道程序和分时切换
		* 实现实时处理
		* 实现操作系统和应用程序的联系（Trap）
		* 多处理机系统各处理机之间的联系
	* CPU响应中断必须满足的条件
		* 中断源有中断请求并且未被屏蔽
		* CPU允许接受中断请求，即开中断
		* 一条指令完毕后才能响应中断
		* 无故障，DMA等优先权更高的请求
* 说明
	* 中断响应：中断响应条件满足，处理机从一个程序切换到另一个程序
	* 中断服务程序：为处理意外情况或有意安排的任务而编写的程序
	* 中断请求的检测与屏蔽：
	* 中断请求触发器：当发生引起中断的事件时先将它保存在设备控制器的中断请求触发器中，即将中断触发器位置置1
	* 堆栈与断点保护
		* 程序被中断的地方为断点，需要保存以备恢复执行时使用
		* 保存程序断点的地方称为栈区，一般采取内存中开辟的专用数据存取区
		* 当产生中断请求，用程序方式有选择的封锁部分中断，为每个中断设置中断屏蔽触发器（标志位）
		* 中断过程：
			* 中断请求：发出
			* 中断响应：满足条件-停止现行程序-准备中端
			* 中断处理
				* 关中断：cpu不响应其他中断 要保存
				* 保存断点：保存PC，程序识别字。。
				* 判别 源 优先级 转入处理过程：挑优先级最高的
				* 开中断：将允许更高级中断请求得到响应
				* 执行中断：
				* 关中断：不响应 要回复
				* 恢复现场
				* 开中断
				* 中断返回
	* 如何获取中断服务程序的入口地址
		* 非向量中断：将服务程序入口组织在查询程序中，查询中断源
		* 向量中断：入口在向量表中，CPU响应时由硬件直接产生向量地址，按地址查表，取得服务程序入口，转入相应服务程序
	* 中断源及优先级判别（软件查询和串行链式排队电路）
		* 软件：由测试程序按照一定优先排队次序检查各个设备的中断触发器（ifelse）
		* 硬件：排队器
* 多重中断
	* 单级中断：执行完现行的中断程序，才响应中断
	* 多重中断：多个中断源按照各自的优先权以嵌套方式工作（级别高先低后）
		* 执行中断时候，开中断，遇到更高级的请求，保存现行中断现场，响应新的中断
	* 实现多重中断的条件
		* 设置开中断
		* 优先级高的能中断优先级低的
* 中断屏蔽技术
	* 中断优先级调整：采用中断屏蔽寄存器，软件设置灵活的优先顺序
	* 设置屏蔽触发器
	* 改变屏蔽码可以不改变硬件实现优先级调整，软排队器
* 中断屏蔽技术的应用
	* 实现多重中断
	* 动态改变优先级（临时调整）qa
